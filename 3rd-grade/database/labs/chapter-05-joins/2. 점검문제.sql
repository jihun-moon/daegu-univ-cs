-- ==================================================
-- SQL 점검문제 정리
-- 이 파일은 제품, 주문세부, 주문, 고객, 마일리지등급 테이블을 대상으로
-- 다양한 집계 및 조인 관련 문제를 포함합니다.
-- 각 문제의 SQL 구문, 처리 목적, 그리고 예상 결과를 주석으로 포함하고 있습니다.
-- ==================================================

---------------------------------------------------------
-- 문제 1번: 제품별 주문 수량 및 주문 금액 합계 계산
-- 목적: 제품 테이블과 주문세부 테이블을 이퀴 조인하여 각 제품의
--       총 주문 수량과 주문 금액 합계를 계산합니다.
SELECT 제품명,
       SUM(주문수량) AS 주문수량합,
       SUM(주문수량 * 주문세부.단가) AS 주문금액합
FROM 제품
INNER JOIN 주문세부
  ON 제품.제품번호 = 주문세부.제품번호
GROUP BY 제품명;

/*
[예상 결과]
--------------------------------------------------------------
| 제품명       | 주문수량합 | 주문금액합      |
--------------------------------------------------------------
| 초콜릿       | 150        | 450,000         |
| 아이스크림   | 200        | 600,000         |
| 사탕         | 120        | 240,000         |
--------------------------------------------------------------
(예시: 각 제품의 총 주문 수량과 총 주문 금액 합계)
*/

---------------------------------------------------------
-- 문제 2번: 주문 연도별 아이스크림 제품 주문 수량 합계 계산
-- 목적: 제품, 주문세부, 주문 테이블을 조인하여, 
--       제품명이 '아이스크림'으로 끝나는 제품의 주문 건수 합계를 
--       주문 연도와 제품명으로 그룹화하여 출력합니다.
SELECT YEAR(주문일) AS 주문년도,
       제품명,
       SUM(주문수량) AS 주문수량합
FROM 제품
INNER JOIN 주문세부
  ON 제품.제품번호 = 주문세부.제품번호
INNER JOIN 주문
  ON 주문.주문번호 = 주문세부.주문번호
WHERE 제품명 LIKE '%아이스크림'
GROUP BY YEAR(주문일), 제품명
ORDER BY 1, 2;

/*
[예상 결과]
--------------------------------------------------------------
| 주문년도 | 제품명             | 주문수량합      |
--------------------------------------------------------------
| 2024     | 바닐라 아이스크림  | 120             |
| 2024     | 초콜릿 아이스크림  | 150             |
| 2025     | 초콜릿 아이스크림  | 180             |
--------------------------------------------------------------
(예시: 주문 연도 및 제품명에 따른 주문 수량 합계)
*/

---------------------------------------------------------
-- 문제 3번: 제품별 주문 수량 합계 계산 (주문 데이터가 없는 제품 포함)
-- 목적: 제품 테이블과 주문세부 테이블을 LEFT OUTER JOIN 하여,
--       주문이 없는 제품도 포함한 각 제품의 주문 수량 합계를 계산합니다.
SELECT 제품명,
       SUM(주문수량) AS '주문수량합'
FROM 제품
LEFT OUTER JOIN 주문세부
  ON 주문세부.제품번호 = 제품.제품번호
GROUP BY 제품명;

/*
[예상 결과]
--------------------------------------------------------------
| 제품명       | 주문수량합      |
--------------------------------------------------------------
| 초콜릿       | 150             |
| 아이스크림   | 200             |
| 사탕         | 120             |
| 젤리         | NULL 또는 0     |
--------------------------------------------------------------
(예시: 주문 데이터가 없는 제품은 주문수량합이 NULL 또는 0으로 표시될 수 있음)
*/

---------------------------------------------------------
-- 문제 4번: 고객별 등급 및 마일리지 정보 조회 (A 등급 대상)
-- 목적: 고객 테이블과 마일리지등급 테이블을 이퀴 조인(범위 조건 사용)하여,
--       등급이 'A'인 고객의 고객번호, 담당자명, 고객회사명, 등급명, 마일리지를 조회합니다.
SELECT 고객번호,
       담당자명,
       고객회사명,
       등급명,
       마일리지
FROM 고객
INNER JOIN 마일리지등급
  ON 마일리지 BETWEEN 하한마일리지 AND 상한마일리지
WHERE 등급명 = 'A';

/*
[예상 결과]
---------------------------------------------------------------
| 고객번호 | 담당자명 | 고객회사명   | 등급명 | 마일리지   |
---------------------------------------------------------------
| C001     | 홍길동   | ABC Corp     | A     | 9500       |
| C005     | 이순신   | DEF Corp     | A     | 8800       |
---------------------------------------------------------------
(예시: 등급이 'A'인 고객의 정보와 해당 마일리지 값)
*/
