-- ==================================================
-- SQL 실습문제 정리 (문제 1번 ~ 4번)
-- 이 파일은 고객, 주문, 주문세부, 마일리지등급 테이블을 활용한 실습문제입니다.
-- 각 문제의 SQL 구문, 처리 목적, 그리고 예상 결과를 주석으로 포함하고 있습니다.
-- ==================================================

---------------------------------------------------------
-- [문제 1번: 고객 등급별 고객 수 집계]
-- 목적: 고객과 마일리지등급 테이블을 조인하여,
--       각 등급별 고객 수를 집계합니다.
SELECT 등급명,
       COUNT(*) AS 고객수
FROM 고객
INNER JOIN 마일리지등급
  ON 마일리지 BETWEEN 하한마일리지 AND 상한마일리지
GROUP BY 등급명;

/*
[예상 결과]
-------------------------------------------------
| 등급명 | 고객수   |
-------------------------------------------------
| A      | 20       |
| B      | 35       |
| C      | 15       |
-------------------------------------------------
(예시: 각 등급별 고객 수가 집계되어 출력됨)
*/

---------------------------------------------------------
-- [문제 2번: 특정 주문번호의 주문 정보 조회]
-- 목적: 고객 테이블과 주문 테이블을 조인하여,
--       주문번호 'H0249'에 해당하는 주문과 관련 고객 정보를 조회합니다.
SELECT *
FROM 고객
INNER JOIN 주문
  ON 주문.고객번호 = 고객.고객번호
WHERE 주문번호 = 'H0249';

/*
[예상 결과]
---------------------------------------------------------------
| 고객번호 | 담당자명 | 고객회사명 | ... | 주문번호 | 주문일   | ... |
---------------------------------------------------------------
| C005     | 이순신   | DEF Corp   | ... | H0249   | 2020-04-09 | ... |
---------------------------------------------------------------
(예시: 주문번호 'H0249'에 해당하는 주문 정보와 연관된 고객 정보가 표시됨)
*/

---------------------------------------------------------
-- [문제 3번: 특정 주문일의 주문 정보 조회]
-- 목적: 고객 테이블과 주문 테이블을 조인하여,
--       주문일 '2020-04-09'에 해당하는 모든 주문 및 관련 고객 정보를 조회합니다.
SELECT *
FROM 고객
INNER JOIN 주문
  ON 주문.고객번호 = 고객.고객번호
WHERE 주문일 = '2020-04-09';

/*
[예상 결과]
------------------------------------------------------------------
| 고객번호 | 담당자명 | 고객회사명 | ... | 주문번호 | 주문일   | ... |
------------------------------------------------------------------
| C001     | 홍길동   | ABC Corp   | ... | H0240   | 2020-04-09 | ... |
| C005     | 이순신   | DEF Corp   | ... | H0249   | 2020-04-09 | ... |
| ...                                                           |
------------------------------------------------------------------
(예시: 주문일이 '2020-04-09'인 모든 주문의 정보와 연관된 고객 정보가 출력됨)
*/

---------------------------------------------------------
-- [문제 4번: 도시별 주문 금액 합계 상위 5개 조회]
-- 목적: 고객, 주문, 주문세부 테이블을 조인하여,
--       각 도시별 총 주문 금액(단가 * 주문수량의 합계)을 계산한 후,
--       주문금액합이 높은 순으로 상위 5개 도시를 조회합니다.
SELECT 도시,
       SUM(단가 * 주문수량) AS 주문금액합
FROM 고객
INNER JOIN 주문
  ON 고객.고객번호 = 주문.고객번호
INNER JOIN 주문세부
  ON 주문.주문번호 = 주문세부.주문번호
GROUP BY 도시
ORDER BY 주문금액합 DESC
LIMIT 5;

/*
[예상 결과]
---------------------------------------------------------
| 도시       | 주문금액합         |
---------------------------------------------------------
| 서울특별시 | 2,500,000          |
| 부산광역시 | 1,800,000          |
| 인천광역시 | 1,200,000          |
| 대구광역시 | 1,100,000          |
| 대전광역시 | 900,000            |
---------------------------------------------------------
(예시: 각 도시별 총 주문 금액을 내림차순 정렬하여 상위 5개 도시 정보가 표시됨)
*/
