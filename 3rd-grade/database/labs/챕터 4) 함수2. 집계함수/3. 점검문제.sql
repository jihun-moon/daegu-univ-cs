-- Query 1: 고객 테이블에서 도시 컬럼의 전체 행 수와 고유 도시 수 구하기
SELECT COUNT(도시) AS 전체_도시_수,
       COUNT(DISTINCT 도시) AS 고유_도시_수
FROM 고객;

/*
[예상 결과]
-------------------------------------
| 전체_도시_수 | 고유_도시_수      |
-------------------------------------
| 100         | 10                |
-------------------------------------
(예: 100행 중 10개의 고유 도시)
*/


-- Query 2: 주문 테이블에서 주문일의 연도를 기준으로 주문 건수 집계
SELECT YEAR(주문일) AS 주문년도,
       COUNT(*) AS 주문건수
FROM 주문
GROUP BY 주문년도;

/*
[예상 결과]
------------------------------------
| 주문년도 | 주문건수                |
------------------------------------
| 2023    | 150                   |
| 2024    | 200                   |
------------------------------------
(예: 각 연도별 주문 건수)
*/


-- Query 3: 주문 테이블에서 주문일의 연도와 분기를 기준으로 주문 건수 집계 (ROLLUP 포함)
SELECT YEAR(주문일) AS 주문년도,
       QUARTER(주문일) AS 분기,
       COUNT(*) AS 주문건수
FROM 주문
GROUP BY 주문년도, 분기
WITH ROLLUP;

/*
[예상 결과]
---------------------------------------------------------
| 주문년도 | 분기   | 주문건수                          |
---------------------------------------------------------
| 2023    | 1      | 40                               |
| 2023    | 2      | 35                               |
| 2023    | 3      | 30                               |
| 2023    | 4      | 45                               |
| 2023    | NULL   | 150   -- 2023년 소계              |
| 2024    | 1      | 50                               |
| 2024    | 2      | 60                               |
| 2024    | 3      | 40                               |
| 2024    | 4      | 50                               |
| 2024    | NULL   | 200   -- 2024년 소계              |
| NULL    | NULL   | 350   -- 전체 합계                |
---------------------------------------------------------
*/


-- Query 4: 주문 테이블에서 요청일이 발송일보다 이전인 주문을 주문월별로 집계
SELECT MONTH(주문일) AS 주문월,
       COUNT(*) AS 주문건수
FROM 주문
WHERE 요청일 < 발송일
GROUP BY 주문월
ORDER BY 주문월;

/*
[예상 결과]
-------------------------------------
| 주문월 | 주문건수                   |
-------------------------------------
| 1      | 20                         |
| 2      | 25                         |
| 3      | 30                         |
| ...    | ...                        |
| 12     | 15                         |
-------------------------------------
(예: 월별 주문 건수)
*/


-- Query 5: 제품 테이블에서 제품명이 '아이스크림'을 포함하는 제품의 재고 합계 구하기
SELECT 제품명,
       SUM(재고) AS 재고합
FROM 제품
WHERE 제품명 LIKE '%아이스크림%'  -- (1) 제품명 필터링
GROUP BY 제품명;
-- (2) HAVING 절 대신 WHERE 절을 사용하여 제품명 필터링
 
/*
[예상 결과]
---------------------------------------------------------
| 제품명             | 재고합                        |
---------------------------------------------------------
| 초코아이스크림     | 150                           |
| 바닐라아이스크림   | 200                           |
---------------------------------------------------------
*/


-- Query 6: 고객 테이블에서 마일리지가 50000 이상이면 'VIP고객', 그렇지 않으면 '일반고객'으로 구분하여 고객수 및 평균 마일리지 집계
SELECT IF(마일리지 >= 50000, 'VIP고객', '일반고객') AS 고객구분,
       COUNT(*) AS 고객수,
       AVG(마일리지) AS 평균마일리지
FROM 고객
GROUP BY 고객구분;

/*
[예상 결과]
-----------------------------------------------------
| 고객구분   | 고객수 | 평균마일리지                 |
-----------------------------------------------------
| VIP고객   | 30     | 75000                        |
| 일반고객  | 70     | 30000                        |
-----------------------------------------------------
*/
